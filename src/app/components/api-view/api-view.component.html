<div class="api-view-outer-container">
    <div class="api-view-container">
        <div class="api-view-breadcrumb-container">
            <div class="api-view-breadcrumb" *ngIf="workflow">
                <p class="active">{{ workflow.name }}</p>
            </div>
            <div class="api-view-slim-button inline" (click)="addRow()">
                <p>Add blank row</p>
            </div>
            <div class="api-view-slim-button text">
                <p>or select an App</p>
            </div>
            <div class="spacer"></div>
            <div class="api-view-slim-button inline" (click)="close()">
                <p>Close View</p>
            </div>
            <p class="cancel" (click)="cancel()">Cancel</p>
            <p class="save" (click)="save()">Save</p>
        </div>
        <div class="api-view-editor-container">
            <div class="api-view-editor" *ngIf="workflow">
                <div class="api-view-editor-row" *ngFor="let row of workflow.rows; index as index" (click)="selectRow(row._id)">
                    <!-- App Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'app'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-app">
                            <p>{{ findAppName(row.appId) }}</p>
                        </div>
                        <div class="api-view-editor-row-variable">
                            <input #rowVariableInputs type="text" placeholder="variable name" [(ngModel)]="row.variable" (input)="adjustVariableWidth(findInputVariableArgsIndex(row._id))">
                        </div>
                        <div class="api-view-editor-row-equals">
                            <p>=</p>
                        </div>
                        <div class="api-view-editor-row-command-open">
                            <p>{{ findAppName(row.appId) }}(</p>
                        </div>
                        <div class="api-view-editor-row-args">
                            <input #rowArgsInputs type="text" placeholder="arguments" [(ngModel)]="row.args" (input)="adjustArgsWidth(findInputVariableArgsIndex(row._id))">
                        </div>
                        <div class="api-view-editor-row-command-close">
                            <p>)</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editworkflowsor-row-detail">
                            <p></p>
                        </div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- Comment Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'comment'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-comment-prefix">
                            <p>//</p>
                        </div>
                        <div class="api-view-editor-row-comment">
                            <input #rowCommentInputs type="text" placeholder="Comment" [(ngModel)]="row.comment" (input)="adjustCommentWidth(findInputCommentIndex(row._id))">
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- If Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'if'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-if">
                            <p>if (</p>
                        </div>
                        <div class="api-view-editor-row-if-end">
                            <p>) &#123;</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- If Close Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'ifClose'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-if-close">
                            <p>&#125;</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- If Else Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'ifElse'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-if-else">
                            <p>if (</p>
                        </div>
                        <div class="api-view-editor-row-if-else-end">
                            <p>) &#123;</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- If Else Middle Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'ifElseMiddle'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-if-else">
                            <p>&#125; else &#123;</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- If Else Close Row -->
                    <ng-content *ngIf="row.appId && rowType(row) === 'ifElseClose'">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-if-else-close">
                            <p>&#125;</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- Blank Row -->
                    <ng-content *ngIf="!row.appId">
                        <div class="api-view-editor-row-prefix" [style.marginRight]="(row.indents * 25) + 'px'">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                </div>
            </div>
        </div>
        <div class="api-view-hidden" *ngIf="workflow">
            <div class="api-view-hidden-rows" *ngFor="let row of workflow.rows;">
                <!-- App Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'app'">
                    <span #rowVariableSpans>{{ row.variable }}</span>
                    <span #rowArgsSpans>{{ row.args }}</span>
                </ng-content>
                <!-- Comment Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'comment'">
                    <span #rowCommentSpans>{{ row.comment }}</span>
                </ng-content>
                <!-- If Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'if'">
                </ng-content>
                <!-- If Close Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'ifClose'">
                </ng-content>
                <!-- If Else Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'ifElse'">
                </ng-content>
                <!-- If Else Middle Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'ifElseMiddle'">
                </ng-content>
                <!-- If Else Close Row -->
                <ng-content *ngIf="row.appId && rowType(row) === 'ifElseClose'">
                </ng-content>
                <!-- Blank Row -->
                <ng-content *ngIf="!row.appId">
                </ng-content>
            </div>
        </div>
    </div>
</div>
