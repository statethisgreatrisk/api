<div class="api-view-outer-container">
    <div class="api-view-container">
        <div class="api-view-breadcrumb-container">
            <div class="api-view-breadcrumb" *ngIf="workflow">
                <p class="active">{{ workflow.name }}</p>
            </div>
            <div class="api-view-slim-button inline" (click)="addRow()">
                <p>Add blank row</p>
            </div>
            <div class="api-view-slim-button text">
                <p>or select an App</p>
            </div>
            <div class="spacer"></div>
            <div class="api-view-slim-button inline" (click)="close()">
                <p>Close View</p>
            </div>
            <p class="cancel" (click)="cancel()">Cancel</p>
            <p class="save" (click)="save()">Save</p>
        </div>
        <div class="api-view-editor-container">
            <div class="api-view-editor" *ngIf="workflow">
                <div class="api-view-editor-row" *ngFor="let row of workflow.rows; index as index" (click)="selectRow(row._id)">
                    <!-- App Row -->
                    <ng-content *ngIf="row.appId && !isCommentRow(row)">
                        <div class="api-view-editor-row-prefix">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-app">
                            <p *ngIf="row.appId">{{ findAppName(row.appId) }}</p>
                        </div>
                        <div class="api-view-editor-row-variable">
                            <input #rowVariableInputs *ngIf="!row.appId" type="text" placeholder="" (input)="adjustVariableWidth(index)" disabled>
                            <input #rowVariableInputs *ngIf="row.appId" type="text" placeholder="variable name" [(ngModel)]="row.variable" (input)="adjustVariableWidth(index)">
                        </div>
                        <div class="api-view-editor-row-equals">
                            <p *ngIf="row.appId">=</p>
                        </div>
                        <div class="api-view-editor-row-command-open">
                            <p *ngIf="row.appId">{{ findAppName(row.appId) }}(</p>
                        </div>
                        <div class="api-view-editor-row-args">
                            <input #rowArgsInputs *ngIf="!row.appId" type="text" (input)="adjustArgsWidth(index)" disabled>
                            <input #rowArgsInputs *ngIf="row.appId" type="text" placeholder="arguments" [(ngModel)]="row.args" (input)="adjustArgsWidth(index)">
                        </div>
                        <div class="api-view-editor-row-command-close">
                            <p *ngIf="row.appId">)</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editworkflowsor-row-detail">
                            <p *ngIf="row.appId"></p>
                        </div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row._id)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- Comment Row -->
                    <ng-content *ngIf="row.appId && isCommentRow(row)">
                        <div class="api-view-editor-row-prefix">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-comment"></div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row._id)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                    <!-- Blank Row -->
                    <ng-content *ngIf="!row.appId">
                        <div class="api-view-editor-row-prefix">
                            <p [ngClass]="{ 'active': selectedRowId === row._id }">{{ index + 1 }}</p>
                        </div>
                        <div class="api-view-editor-row-spacer"></div>
                        <div class="api-view-editor-row-remove" (click)="removeRow(row._id)">
                            <img src="/x.png">
                        </div>
                    </ng-content>
                </div>
            </div>
        </div>
        <div class="api-view-hidden" *ngIf="workflow">
            <div class="api-view-hidden-rows" *ngFor="let row of workflow.rows;">
                <span #rowVariableSpans>{{ row.variable }}</span>
                <span #rowArgsSpans>{{ row.args }}</span>
            </div>
        </div>
    </div>
</div>
